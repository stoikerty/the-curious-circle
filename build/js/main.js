document.addEventListener("DOMContentLoaded",function(){!function(t){function i(t,i,n){t.style["-webkit-transform"]="translate("+i+"px, "+n+"px)",t.style["-moz-transform"]="translate("+i+"px, "+n+"px)",t.style["-ms-transform"]="translate("+i+"px, "+n+"px)",t.style["-o-transform"]="translate("+i+"px, "+n+"px)",t.style.transform="translate("+i+"px, "+n+"px)"}function n(t){return"[object Number]"===toString.call(t)}function s(t,s,e){return this._gridSize=t,this._worldSize=s,this._worldElement=e,this._gridCells=this._worldElement.querySelector(".grid-cells"),this._gridElement=this._gridCells.querySelector(".cell"),this._robotElement=this._worldElement.querySelector(".robot"),this._pointerElement=this._robotElement.querySelector(".pointer"),this._orientation=null,this._x=null,this._y=null,this._dead=null,this._scentedPositions=[],this._init=function(){var t=this;t._robotElement.classList.add("is-dead"),t._dead=!0,setTimeout(function(){t._moveTo(0,0),t._turn("north"),setTimeout(function(){t._robotElement.classList.remove("is-dead"),t._dead=!1},200)},200)},this._moveForward=function(){"north"==this._orientation&&this._move(0,1),"east"==this._orientation&&this._move(1,0),"south"==this._orientation&&this._move(0,-1),"west"==this._orientation&&this._move(-1,0)},this._turn=function(t){var i="";this._pointerElement.classList.remove("north","east","south","west"),"left"==t&&("north"==this._orientation&&(i="west"),"east"==this._orientation&&(i="north"),"south"==this._orientation&&(i="east"),"west"==this._orientation&&(i="south")),"right"==t&&("north"==this._orientation&&(i="east"),"east"==this._orientation&&(i="south"),"south"==this._orientation&&(i="west"),"west"==this._orientation&&(i="north")),["north","east","south","west"].indexOf(t)>-1&&(i=t),this._orientation=i,this._pointerElement.classList.add(this._orientation)},this._move=function(t,i){this._moveTo(this._x+t,this._y+i)},this._moveTo=function(t,s){var e=this;if(e._robotElement.classList.add("is-moving"),setTimeout(function(){e._robotElement.classList.remove("is-moving")},200),t>this._worldSize||0>t||s>this._worldSize||0>s){n(t)&&n(s)||(n(t)&&(this._checkOrientation(this._x,t,null,null),this._x=Math.min(Math.max(t,0),this._worldSize)),n(s)&&(this._checkOrientation(null,null,this._y,s),this._y=Math.min(Math.max(s,0),this._worldSize)));var o={orientation:this._orientation,x:Math.min(Math.max(this._x,0),this._worldSize),y:Math.min(Math.max(this._y,0),this._worldSize)},r=this._isPositionScented(o.orientation,o.x,o.y);r?(i(this._robotElement,this._x*this._gridSize,-this._y*this._gridSize),r.classList.add("is-stepped-on"),e._robotElement.classList.remove("is-moving"),e._robotElement.classList.add("is-not-moving"),setTimeout(function(){r.classList.remove("is-stepped-on"),e._robotElement.classList.remove("is-not-moving")},400)):(this._addScentedPosition(o.orientation,o.x,o.y),this._init())}else n(t)&&(this._x=t),n(s)&&(this._y=s),i(this._robotElement,this._x*this._gridSize,-this._y*this._gridSize)},this._checkOrientation=function(t,i,n,s){t&&i&&i>t?this._turn("east"):this._turn("west"),n&&s&&s>n?this._turn("south"):this._turn("north")},this._isPositionScented=function(t,i,n){var s=!1,e=!1;return this._scentedPositions.forEach(function(o){o.x==i&&o.y==n&&(s&&o.orientation==t?e=o.cell:s||(e=o.cell))}),e},this._addScentedPosition=function(t,n,s){var e=this._gridElement.cloneNode(!0);i(e,n*this._gridSize,-s*this._gridSize),setTimeout(function(){e.classList.add("is-active")},200),this._scentedPositions.push({orientation:t,x:n,y:s,cell:e}),this._gridCells.appendChild(e)},this.isDead=function(){return this._dead},this.moveForward=function(){this._moveForward()},this.turnLeft=function(){this._turn("left")},this.turnRight=function(){this._turn("right")},this.orientation=function(t){this._turn(t)},this.moveTo=function(t,i,n){t?(this._moveTo(i,null),this._dead||this._moveTo(null,n)):this._moveTo(i,n)},this._init()}function e(t,i){for(var n=0;n<t.length;n++)if(t[n]){var s=t[n];setTimeout(function(t){"finish"!==t&&"-"!==t?x.processText(t):"-"==t?d.innerHTML=d.innerHTML+"<br>":(d.innerHTML=d.innerHTML+"<br><br> { Test Data completed } <br>",x.processText("0 0 N"))}.bind(this,s),i*n)}}function o(t){t=t||window.event,"38"==t.keyCode?(p.click(),p.classList.add("is-clicked"),setTimeout(function(){p.classList.remove("is-clicked")},200)):"37"==t.keyCode?(L.click(),L.classList.add("is-clicked"),setTimeout(function(){L.classList.remove("is-clicked")},200)):"39"==t.keyCode&&(f.click(),f.classList.add("is-clicked"),setTimeout(function(){f.classList.remove("is-clicked")},200))}function r(){this.processText=function(t){var i=t.split(" ");if(parseInt(t[0],10)>=0){for(var n,s,e="",o=0;o<i.length;o++)if(2>o){var r=Math.min(parseInt(i[o],10),50);0==o&&(n=r),1==o&&(s=r)}else if(2==o){var a=i[o][0].toUpperCase();"N"===a&&(e="north"),"E"===a&&(e="east"),"W"===a&&(e="west"),"S"===a&&(e="south")}this.processPosition(n,s,e)}else this.processInstructions(t)},this.processPosition=function(i,n,s){""!==d.innerHTML&&(d.innerHTML=d.innerHTML+"<br>"),d.appendChild(t.createTextNode(i+" "+n+" "+(s[0]?s[0].toUpperCase():""))),T.moveTo(!0,i,n),T.isDead()?d.innerHTML=d.innerHTML+" LOST":s&&"none"!==s&&T.orientation(s),d.scrollTop=d.scrollHeight},this.processInstructions=function(i){for(var n="",s=0;s<i.length;s++){var e=i[s].toUpperCase();if("F"===e&&T.moveForward(),"L"===e&&T.turnLeft(),"R"===e&&T.turnRight(),n+=e,T.isDead()){n+=" LOST";break}}""!==d.innerHTML&&(d.innerHTML=d.innerHTML+"<br>"),d.appendChild(t.createTextNode(n.toUpperCase())),d.scrollTop=d.scrollHeight}}function a(t){this._position={x:!1,y:!1,orientation:!1},this._numPadEl=t,this._numpadButton={},this._init=function(){this._position={x:!1,y:!1,orientation:!1},this._numpadButton.x=this._numPadEl.querySelector(".position .x"),this._numpadButton.y=this._numPadEl.querySelector(".position .y"),this._numpadButton.orientation=this._numPadEl.querySelector(".position .orientation"),this._numpadButton.x.addEventListener("click",function(t){t.stopPropagation(),S.toggleX()}),this._numpadButton.y.addEventListener("click",function(t){t.stopPropagation(),S.toggleY()}),this._numpadButton.orientation.addEventListener("click",function(t){t.stopPropagation(),S.toggleOrientation()});for(var t=this._numPadEl.querySelectorAll(".numbers button"),i=0;i<t.length;i++)t[i].addEventListener("click",function(t){t.stopPropagation();var i=t.target.classList.contains("confirm");S.enterValue(t.target.getAttribute("data-number"),t.target.getAttribute("data-orientation"),i)})},this.toggleX=function(){this._position.x=!this._position.x,this._position.y=!1,this._position.orientation=!1,this.showType()},this.toggleY=function(){this._position.x=!1,this._position.y=!this._position.y,this._position.orientation=!1,this.showType()},this.toggleOrientation=function(){this._position.x=!1,this._position.y=!1,this._position.orientation=!this._position.orientation,this.showType()},this.showType=function(){this._position.x?(this._numpadButton.x.classList.add("is-active"),this._numPadEl.classList.add("number-mode")):(this._numpadButton.x.classList.remove("is-active"),this._numPadEl.classList.contains("number-mode")&&this._numPadEl.classList.remove("number-mode")),this._position.y?(this._numpadButton.y.classList.add("is-active"),this._numPadEl.classList.add("number-mode")):(this._numpadButton.y.classList.remove("is-active"),!this._position.x&&this._numPadEl.classList.contains("number-mode")&&this._numPadEl.classList.remove("number-mode")),this._position.orientation?(this._numpadButton.orientation.classList.add("is-active"),this._numPadEl.classList.add("orientation-mode")):(this._numpadButton.orientation.classList.remove("is-active"),this._numPadEl.classList.contains("orientation-mode")&&this._numPadEl.classList.remove("orientation-mode")),this._numPadEl.classList.contains("number-mode")||this._numPadEl.classList.contains("orientation-mode")?this._numPadEl.classList.contains("disabled-mode")&&this._numPadEl.classList.remove("disabled-mode"):this._numPadEl.classList.add("disabled-mode")},this.enterValue=function(t,i,n){if(!this._numPadEl.classList.contains("disabled-mode")){var s=this._numPadEl.querySelector(".position .is-active");if(n||this._position.orientation){if(!n&&this._position.orientation&&i.length>2)s.innerHTML=i,s.classList.add("is-modified");else if(n)if(s.classList.contains("is-modified")){s.disabled=!0,this._position.orientation||(s.innerHTML=Math.min(parseInt(s.innerHTML,10),50)),s.classList.remove("is-active"),this._position={x:!1,y:!1,orientation:!1},this.showType();var e=this._numPadEl.querySelectorAll(".position button:disabled");if(3==e.length){for(var o=0;o<e.length;o++)e[o].disabled=!1;var r=this;r._numPadEl.classList.add("is-resetting"),setTimeout(function(){x.processPosition(parseInt(r._numpadButton.x.innerHTML,10),parseInt(r._numpadButton.y.innerHTML,10),r._numpadButton.orientation.innerHTML),r._numpadButton.x.innerHTML="X",r._numpadButton.y.innerHTML="Y",r._numpadButton.orientation.innerHTML="orientation",r._numPadEl.classList.remove("is-resetting")},700)}}else this._position={x:!1,y:!1,orientation:!1},this.showType()}else parseInt(s.innerHTML,10)>=0||(s.innerHTML=""),s.innerHTML=s.innerHTML+t,s.classList.add("is-modified")}},this._init()}var l=t.querySelector(".world-grid"),h=t.querySelector(".instructions"),c=t.querySelector(".command-input"),d=t.querySelector(".history"),u=t.querySelector(".numpad"),_=t.querySelector(".info-container"),m=t.querySelector(".info-container .toggle"),p=h.querySelector(".forward"),L=h.querySelector(".left"),f=h.querySelector(".right"),v=t.querySelector(".test-sample"),g=t.querySelector(".dance"),y=t.querySelector(".robot").offsetWidth,E=Math.floor(l.offsetWidth/y)-1,T=new s(y,E,l);m.addEventListener("click",function(t){t.stopPropagation(),_.classList.toggle("is-active"),l.classList.toggle("is-active"),c.classList.toggle("is-active")}),p.addEventListener("click",function(t){t.stopPropagation(),x.processInstructions("F")}),L.addEventListener("click",function(t){t.stopPropagation(),x.processInstructions("L")}),f.addEventListener("click",function(t){t.stopPropagation(),x.processInstructions("R")}),v.addEventListener("click",function(t){t.stopPropagation();var i=["5 3","1 1 E","RFRFRFRF","-","3 2 N","FRRFLLFFRRFLL","-","0 3 W","LLFFFLFLFL",null,"finish"];e(i,600)}),g.addEventListener("click",function(t){t.stopPropagation();var i=["0 -1","1 -1","2 -1","3 -1","4 -1","5 -1","6 -1","7 -1","8 -1","9 -1","10 -1","11 -1","12 -1","13 -1","0 50","1 50","2 50","3 50","4 50","5 50","6 50","7 50","8 50","9 50","10 50","11 50","12 50","13 50","-","6 3 E","6 3 S","6 3 N","6 3 W","6 3 E","6 3 N","6 3 N","5 3 S","F","F","F","F","L","L","F","F","F","R","R","R","R","R","R","L","L","L","L","L","L","6 12 S","F","F","F","F","R","F","F","F","F","L","R","R","9 5 E","9 5 S","9 5 N","9 5 W","12 4 E","12 4 N","12 4 W","12 4 N","12 4 S",null,"finish"];e(i,600)}),t.onkeydown=o,c.querySelector(".current-input").addEventListener("keydown",function(t){t.stopPropagation();var i=t.target.value;13==t.keyCode&&(t.target.value="",x.processText(i))});var x=new r,S=new a(u)}(document)});